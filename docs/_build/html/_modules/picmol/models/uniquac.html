<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>picmol.models.uniquac &#8212; picmol 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nature.css?v=279e0f84" />
    <script src="../../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">picmol 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">picmol.models.uniquac</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for picmol.models.uniquac</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.unifac_subgroups.fragmentation</span><span class="w"> </span><span class="kn">import</span> <span class="n">Groups</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.cem</span><span class="w"> </span><span class="kn">import</span> <span class="n">PointDisc</span>

<span class="k">def</span><span class="w"> </span><span class="nf">UNIQUAC_R</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
	<span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="n">Groups</span><span class="p">(</span><span class="n">smile</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">smile</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gg</span><span class="o">.</span><span class="n">unifac</span><span class="o">.</span><span class="n">r</span> <span class="k">for</span> <span class="n">gg</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span>
	<span class="k">return</span> <span class="n">r</span>

<span class="k">def</span><span class="w"> </span><span class="nf">UNIQUAC_Q</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
	<span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="n">Groups</span><span class="p">(</span><span class="n">smile</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">smile</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>
	<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gg</span><span class="o">.</span><span class="n">unifac</span><span class="o">.</span><span class="n">q</span> <span class="k">for</span> <span class="n">gg</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span>
	<span class="k">return</span> <span class="n">q</span>

<span class="k">def</span><span class="w"> </span><span class="nf">UNIQUAC_RQ</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
	<span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="n">Groups</span><span class="p">(</span><span class="n">smile</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">smile</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gg</span><span class="o">.</span><span class="n">unifac</span><span class="o">.</span><span class="n">r</span> <span class="k">for</span> <span class="n">gg</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span>
	<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gg</span><span class="o">.</span><span class="n">unifac</span><span class="o">.</span><span class="n">q</span> <span class="k">for</span> <span class="n">gg</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span>
	<span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">q</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fit_du_to_Hmix</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Hmix</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">smiles</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot; fit UNIQUAC interaction parameters &quot;&quot;&quot;</span>

	<span class="n">N_mols</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">r</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">UNIQUAC_RQ</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
	
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;Rc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.314E-3</span>
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">create_du_function</span><span class="p">(</span><span class="n">ij</span><span class="p">):</span>
			<span class="c1"># Validate inputs</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ij</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;ij must be integer.&quot;</span><span class="p">)</span>

			<span class="c1"># Generate argument names</span>
			<span class="n">du_arg_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;du</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ij</span><span class="p">)]</span>
			<span class="c1"># Include &#39;z&#39; at the beginning of the argument list</span>
			<span class="n">arg_list</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">du_arg_names</span><span class="p">)</span>  <span class="c1"># e.g., &#39;z, du0, du1, du2&#39;</span>

			<span class="c1"># Build the function code as a string</span>
			<span class="n">func_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">def UNIQUAC_Hmix_fit_func(</span><span class="si">{</span><span class="n">arg_list</span><span class="si">}</span><span class="s2">):</span>
<span class="s2">			</span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
<span class="s2">			Processes &#39;z&#39; and &#39;du&#39; arguments in range du_</span><span class="si">{</span><span class="n">ij</span><span class="si">}</span><span class="s2">.</span>

<span class="s2">			Parameters:</span>
<span class="s2">			z : numeric</span>
<span class="s2">	</span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;    </span><span class="si">{}</span><span class="s1"> : numeric&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">du_arg_names</span><span class="p">])</span><span class="si">}</span>
<span class="s2">			</span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>

<span class="s2">			# Collect &#39;du&#39; arguments into a list</span>
<span class="s2">			du_list = [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">du_arg_names</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span>
<span class="s2">			N_mols = z.shape[1]</span>

<span class="s2">			du = np.zeros((N_mols, N_mols))</span>

<span class="s2">			ij = 0</span>
<span class="s2">			for i in range(N_mols):</span>
<span class="s2">				for j in range(N_mols):</span>
<span class="s2">					if i &lt; j:</span>
<span class="s2">						du[i,j] = du_list[ij]</span>
<span class="s2">						du[j,i] = du_list[ij]</span>
<span class="s2">						ij += 1</span>
<span class="s2">			</span>
<span class="s2">			r = globals()[&#39;r&#39;]</span>
<span class="s2">			q = globals()[&#39;q&#39;]</span>
<span class="s2">			Rc = globals()[&#39;Rc&#39;]</span>
<span class="s2">			T = globals()[&#39;T&#39;]</span>

<span class="s2">			zc = 10</span>
<span class="s2">			l = (zc / 2) * (r - q) - (r - 1)</span>
<span class="s2">			tau = np.exp(-du / (Rc * T))</span>
<span class="s2">			rbar = z @ r</span>
<span class="s2">			qbar = z @ q</span>
<span class="s2">			# Calculate phi and theta (segment and area fractions)</span>
<span class="s2">			phi = z * (1 / rbar[:, None]) * r</span>
<span class="s2">			theta = z * (1 / qbar[:, None]) * q</span>
<span class="s2">			# Solve for free energy of mixing GM </span>
<span class="s2">			GM_res = -Rc * T * (z * np.log(np.dot(theta , tau))) @ q</span>
<span class="s2">			return GM_res</span>
<span class="s2">&quot;&quot;&quot;</span>
			<span class="c1"># Create a local namespace for the function definition</span>
			<span class="n">func_namespace</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="c1"># Include &#39;__name__&#39; in the globals dictionary</span>
			<span class="n">exec</span><span class="p">(</span><span class="n">func_code</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">func_namespace</span><span class="p">)</span>
			<span class="c1"># Retrieve the dynamically created function</span>
			<span class="n">du_function</span> <span class="o">=</span> <span class="n">func_namespace</span><span class="p">[</span><span class="s1">&#39;UNIQUAC_Hmix_fit_func&#39;</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">du_function</span>
	
	<span class="n">ij_combo</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
				<span class="n">ij_combo</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="n">UNIQUAC_Hmix_fit</span> <span class="o">=</span> <span class="n">create_du_function</span><span class="p">(</span><span class="n">ij_combo</span><span class="p">)</span>

	<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">UNIQUAC_Hmix_fit</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">Hmix</span><span class="p">)</span>

	<span class="n">du</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_mols</span><span class="p">,</span> <span class="n">N_mols</span><span class="p">))</span>
	<span class="n">ij</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
				<span class="n">du</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span>
				<span class="n">du</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span>
				<span class="n">ij</span> <span class="o">+=</span> <span class="mi">1</span>
		
	<span class="k">return</span> <span class="n">du</span>


<span class="k">def</span><span class="w"> </span><span class="nf">fit_du_to_GM</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">GM</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">smiles</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot; fit UNIQUAC interaction parameters &quot;&quot;&quot;</span>

	<span class="n">N_mols</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">r</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">UNIQUAC_RQ</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
	
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;Rc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.314E-3</span>
	<span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">create_du_function</span><span class="p">(</span><span class="n">ij</span><span class="p">):</span>
			<span class="c1"># Validate inputs</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ij</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;ij must be integer.&quot;</span><span class="p">)</span>

			<span class="c1"># Generate argument names</span>
			<span class="n">du_arg_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;du</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ij</span><span class="p">)]</span>
			<span class="c1"># Include &#39;z&#39; at the beginning of the argument list</span>
			<span class="n">arg_list</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">du_arg_names</span><span class="p">)</span>  <span class="c1"># e.g., &#39;z, du0, du1, du2&#39;</span>

			<span class="c1"># Build the function code as a string</span>
			<span class="n">func_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">def UNIQUAC_GM_fit_func(</span><span class="si">{</span><span class="n">arg_list</span><span class="si">}</span><span class="s2">):</span>
<span class="s2">			</span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
<span class="s2">			Processes &#39;z&#39; and &#39;du&#39; arguments in range du_</span><span class="si">{</span><span class="n">ij</span><span class="si">}</span><span class="s2">.</span>

<span class="s2">			Parameters:</span>
<span class="s2">			z : numeric</span>
<span class="s2">	</span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;    </span><span class="si">{}</span><span class="s1"> : numeric&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">du_arg_names</span><span class="p">])</span><span class="si">}</span>
<span class="s2">			</span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>

<span class="s2">			# Collect &#39;du&#39; arguments into a list</span>
<span class="s2">			du_list = [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">du_arg_names</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span>
<span class="s2">			N_mols = z.shape[1]</span>

<span class="s2">			du = np.zeros((N_mols, N_mols))</span>

<span class="s2">			ij = 0</span>
<span class="s2">			for i in range(N_mols):</span>
<span class="s2">				for j in range(N_mols):</span>
<span class="s2">					if i &lt; j:</span>
<span class="s2">						du[i,j] = du_list[ij]</span>
<span class="s2">						du[j,i] = du_list[ij]</span>
<span class="s2">						ij += 1</span>
<span class="s2">			</span>
<span class="s2">			r = globals()[&#39;r&#39;]</span>
<span class="s2">			q = globals()[&#39;q&#39;]</span>
<span class="s2">			Rc = globals()[&#39;Rc&#39;]</span>
<span class="s2">			T = globals()[&#39;T&#39;]</span>

<span class="s2">			zc = 10</span>
<span class="s2">			l = (zc / 2) * (r - q) - (r - 1)</span>
<span class="s2">			tau = np.exp(-du / (Rc * T))</span>
<span class="s2">			rbar = z @ r</span>
<span class="s2">			qbar = z @ q</span>
<span class="s2">			# Calculate phi and theta (segment and area fractions)</span>
<span class="s2">			phi = z * (1 / rbar[:, None]) * r</span>
<span class="s2">			theta = z * (1 / qbar[:, None]) * q</span>
<span class="s2">			# Solve for free energy of mixing GM </span>
<span class="s2">			GM_comb = Rc * T * (np.sum(z * np.log(phi), axis=1) + (zc / 2) * (z * (np.log(theta) - np.log(phi))) @ q)</span>
<span class="s2">			GM_res = -Rc * T * (z * np.log(np.dot(theta , tau))) @ q</span>
<span class="s2">			return GM_comb + GM_res</span>
<span class="s2">&quot;&quot;&quot;</span>
			<span class="c1"># Create a local namespace for the function definition</span>
			<span class="n">func_namespace</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="c1"># Include &#39;__name__&#39; in the globals dictionary</span>
			<span class="n">exec</span><span class="p">(</span><span class="n">func_code</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">func_namespace</span><span class="p">)</span>
			<span class="c1"># Retrieve the dynamically created function</span>
			<span class="n">du_function</span> <span class="o">=</span> <span class="n">func_namespace</span><span class="p">[</span><span class="s1">&#39;UNIQUAC_GM_fit_func&#39;</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">du_function</span>
	
	<span class="n">ij_combo</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
				<span class="n">ij_combo</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="n">UNIQUAC_GM_fit</span> <span class="o">=</span> <span class="n">create_du_function</span><span class="p">(</span><span class="n">ij_combo</span><span class="p">)</span>

	<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">UNIQUAC_GM_fit</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">GM</span><span class="p">)</span>

	<span class="n">du</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_mols</span><span class="p">,</span> <span class="n">N_mols</span><span class="p">))</span>
	<span class="n">ij</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_mols</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
				<span class="n">du</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span>
				<span class="n">du</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span>
				<span class="n">ij</span> <span class="o">+=</span> <span class="mi">1</span>
		
	<span class="k">return</span> <span class="n">du</span>



<div class="viewcode-block" id="UNIQUAC">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">UNIQUAC</span><span class="p">:</span>
	
	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IP</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">du</span> <span class="o">=</span> <span class="n">IP</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="mi">10</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="mf">8.314E-3</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>

		<span class="n">num_pts</span> <span class="o">=</span> <span class="p">{</span>
			<span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">4</span>
		<span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">num_comp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">rec_steps</span> <span class="o">=</span> <span class="n">num_pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">num_comp</span><span class="p">]</span>

		<span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">point_disc</span> <span class="o">=</span> <span class="n">PointDisc</span><span class="p">(</span><span class="n">num_comp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_comp</span><span class="p">,</span> <span class="n">recursion_steps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_steps</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">point_disc</span><span class="o">.</span><span class="n">points_mfr</span>    
		
		<span class="bp">self</span><span class="o">.</span><span class="n">smiles</span> <span class="o">=</span> <span class="n">smiles</span>

		<span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">q</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_r</span> <span class="o">=</span> <span class="n">r</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_q</span> <span class="o">=</span> <span class="n">q</span>


<div class="viewcode-block" id="UNIQUAC.update_z">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.update_z">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">update_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">new_value</span></div>


	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_r</span> 
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_r</span> <span class="o">=</span> <span class="n">UNIQUAC_R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smiles</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">q</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_q</span>
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_q</span> <span class="o">=</span> <span class="n">UNIQUAC_Q</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smiles</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">l</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">rbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
	
	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">qbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
	
	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">lbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">rr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">qq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
	
	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">ll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">phi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">theta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">qbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
	
<div class="viewcode-block" id="UNIQUAC.tau">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.tau">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">tau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">du</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span></div>


<div class="viewcode-block" id="UNIQUAC.rho">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.rho">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></div>


<div class="viewcode-block" id="UNIQUAC.GE">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.GE">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">GE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;excess energy&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GE_res</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GE_comb</span><span class="p">(</span><span class="n">T</span><span class="p">))</span></div>

	
<div class="viewcode-block" id="UNIQUAC.GE_res">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.GE_res">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">GE_res</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">))))</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span></div>

	
<div class="viewcode-block" id="UNIQUAC.GE_comb">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.GE_comb">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">GE_comb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="n">ge_comb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)))</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">ge_comb</span></div>

	
<div class="viewcode-block" id="UNIQUAC.Gid">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.Gid">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">Gid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="UNIQUAC.GM">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.GM">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">GM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;mixing free energy&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GE</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gid</span><span class="p">(</span><span class="n">T</span><span class="p">))</span></div>

	
<div class="viewcode-block" id="UNIQUAC.gammas">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.gammas">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">gammas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;activity coefficients&#39;&#39;&#39;</span>

		<span class="n">theta_tau_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
			<span class="n">theta_tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
				<span class="n">theta_tau</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">T</span><span class="p">)[:,</span><span class="n">j</span><span class="p">]</span>
			<span class="n">theta_tau_j</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_tau</span>

		<span class="n">gammas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ll</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-</span>  <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span>  <span class="n">theta_tau_j</span>

		<span class="k">return</span> <span class="n">gammas</span></div>

	

<div class="viewcode-block" id="UNIQUAC.mu">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.mu">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">mu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;calculates the chemical potential&#39;&#39;&#39;</span>

		<span class="n">mu_comb</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ll</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">])]))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

		<span class="n">mu_res</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">))))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">))))</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)))</span>

		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu_comb</span> <span class="o">+</span> <span class="n">mu_res</span><span class="p">)</span></div>

	

<div class="viewcode-block" id="UNIQUAC.dGM_dxs">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.dGM_dxs">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">dGM_dxs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;calculates the first derivative of mixing free energy&#39;&#39;&#39;</span>
		<span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
		<span class="n">dGM_dxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
			<span class="n">dGM_dxs</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mu</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">dGM_dxs</span></div>



<div class="viewcode-block" id="UNIQUAC.dmu_dz">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.dmu_dz">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">dmu_dz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;calculates the second derivative via analytical functions&#39;&#39;&#39;</span>

		<span class="n">ones_2darr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">])])</span>
		<span class="n">dmu_dz_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>

		<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
			<span class="n">i_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">])])</span>
			<span class="n">i_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

			<span class="n">dphi_dz1</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">i_arr</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rr</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">@</span> <span class="n">ones_2darr</span><span class="p">)</span>
			<span class="n">dtheta_dz1</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">i_arr</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">@</span> <span class="n">ones_2darr</span><span class="p">)</span>

			<span class="n">dmu_comb1_dz1</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span><span class="p">)</span> <span class="o">*</span> <span class="n">dphi_dz1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">qq</span> <span class="o">*</span> <span class="n">dtheta_dz1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>

			<span class="n">dmu_comb2_dz1</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lbar</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">@</span> <span class="n">ones_2darr</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dphi_dz1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="o">@</span> <span class="n">i_arr</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

			<span class="n">dmu_dzi</span> <span class="o">=</span> <span class="n">dmu_comb1_dz1</span> <span class="o">+</span> <span class="n">dmu_comb2_dz1</span>
			<span class="n">dmu_dz_comb</span><span class="p">[:,</span><span class="n">ii</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">dmu_dzi</span>
		
		<span class="n">dmu_dz_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
		<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
			<span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
				<span class="n">dmu_dz_res</span><span class="p">[:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qbar</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)[</span><span class="n">jj</span><span class="p">][</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">T</span><span class="p">)[:,</span><span class="n">ii</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">T</span><span class="p">)[:,</span><span class="n">jj</span><span class="p">])</span> <span class="o">+</span> <span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">T</span><span class="p">)[</span><span class="n">jj</span><span class="p">]))</span>
		
		<span class="n">dmu_dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">dmu_dz_comb</span> <span class="o">+</span> <span class="n">dmu_dz_res</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">dmu_dz</span></div>



<div class="viewcode-block" id="UNIQUAC.Hij">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.Hij">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">Hij</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="n">dmu_dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dmu_dz</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
		<span class="n">Hij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
		<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
				<span class="n">Hij</span><span class="p">[:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">dmu_dz</span><span class="p">[:,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span><span class="o">-</span><span class="n">dmu_dz</span><span class="p">[:,</span><span class="n">ii</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">dmu_dz</span><span class="p">[:,</span><span class="n">n</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">dmu_dz</span><span class="p">[:,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">Hij</span></div>

	

<div class="viewcode-block" id="UNIQUAC.det_Hij">
<a class="viewcode-back" href="../../../index.html#picmol.UNIQUAC.det_Hij">[docs]</a>
	<span class="k">def</span><span class="w"> </span><span class="nf">det_Hij</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Hij</span><span class="p">(</span><span class="n">T</span><span class="p">))</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">picmol 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">picmol.models.uniquac</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Allison A. Peroutka.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>